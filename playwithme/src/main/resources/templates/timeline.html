<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"><head>
    <head>
        <meta charset="UTF-8">
        <title>Your Timeline</title>
        <!-- 버튼 부트스트랩 -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
        <!-- 폰트어썸 아이콘 -->
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
        <link rel="stylesheet" href="/mypage/timeline/style.css" />
    </head>
<body>

<section class="intro">
    <div class="container">
        <h1> TimeLine <i class="fa fa-history" aria-hidden="true"></i> </h1>
    </div>
</section>

<section class="timeline">
    <ul>
        <li th:each="events, num : ${events}">
            <div>

                <!--이벤트 날짜-->
                <span class="timeline-content-info-date">
                    [[${#strings.substring(events.date,0,10)}]]
                </span>

                <!-- 이벤트 이름-->
                <h3>
                    [[${events.name}]]
                </h3>

                <!-- 이벤트 장소-->
                <span class="timeline-content-info-title">
                    <!-- 아이콘 -->
                    <i class="fa fa-certificate" aria-hidden="true"></i>
                    [[${events.location}]]
                </span>

                <!-- 메모 작성폼-->
                <span th:each="timelines, num2 : ${timelines}">
                    <span th:if="${num.index}==${num2.index}">
                        <form onsubmit="spaceCheck(this); return false;"
                              th:if="${timelines.memo}==null"
                              th:action="@{|/mypage/timeline/memo/${timelines.id}|}" method="post"
                              th:object="${requestDto}">
                            <textarea th:field="*{memo}" id="new-memo" class="form-control" rows="3" placeholder="Write your own memo here!"></textarea>
                            <input type="submit" value="등록" class="btn btn-dark btn-sm">
                        </form>
                    </span>
                </span>

                <span th:each="timelines, num2 : ${timelines}">
                    <span th:if="${num.index}==${num2.index} and ${timelines.memo}!=null">
                        <span id="show-memo-box" th:classappend="${timelines.id}">
                            <!--메모 조회-->
                            <span id="memo" th:text="${timelines.memo}" th:classappend="${timelines.id}"></span>
                            <!-- 메모 수정 버튼-->
                            <button id="btn-memo-update" class="btn btn-dark btn-sm" th:onclick="findIdToHide([[${timelines.id}]]); findIdToShow([[${num2.index}]]);" th:classappend="${timelines.id}"><i class="fa fa-pencil" aria-hidden="true"></i></button>
                            <!--메모 삭제 버튼--> <!--TODO-->
                            <button id="btn-memo-delete" class="btn btn-dark btn-sm" th:onclick="confirmMsg([[${events.name}]],[[${timelines.id}]])" th:classappend="${timelines.id}"><i class="fa fa-times" aria-hidden="true"></i></button>
                        </span>
                        <!--메모 수정폼-->
                        <form id ="memo-update-form"
                              th:classappend="${num2.index}"
                              th:action="@{|/mypage/timeline/memo/modify/${timelines.id}|}" method="post">

                            <input type="hidden" id="togethersId"  th:value="${timelines.id}">
                            <textarea class="form-control" id="update-memo" rows="3" name="memo" th:text="${timelines.memo}"></textarea>

                            <input type="submit" value="저장" class="btn btn-dark btn-sm">
                            <input type="button" value="수정취소" onClick="window.location.reload()" class="btn btn-dark btn-sm">
                        </form>
                    </span>
                </span>

            </div>
        </li>
    </ul>
</section>
<script src="/mypage/timeline/main.js"></script>
</body>
</html>
